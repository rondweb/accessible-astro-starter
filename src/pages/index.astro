---
import DefaultLayout from '@layouts/DefaultLayout.astro'
import Hero from '@components/Hero.astro'
import { Heading, Link } from 'accessible-astro-components'
import { Icon } from 'astro-icon/components'
import { getCollection } from 'astro:content'

// Fun√ß√£o para criar slug amig√°vel para URL a partir do t√≠tulo do produto
function createProductSlug(title: string): string {
  return title
    .toLowerCase()
    .normalize('NFD')
    .replace(/[\u0300-\u036f]/g, '') // Remove acentos
    .replace(/[^a-z0-9\s-]/g, '') // Remove caracteres especiais
    .trim()
    .replace(/\s+/g, '-') // Substitui espa√ßos por h√≠fens
    .replace(/-+/g, '-') // Remove h√≠fens m√∫ltiplos
    .replace(/^-|-$/g, '') // Remove h√≠fens do in√≠cio e fim
}

// Obter produtos e agrupar por categoria
const products = await getCollection('products')
const productsByCategory = products.reduce((acc, product) => {
  const category = product.data.category
  if (!acc[category]) {
    acc[category] = []
  }
  acc[category].push(product)
  return acc
}, {} as Record<string, any[]>)

// Definir categorias dispon√≠veis com seus dados
const categories = [
  {
    slug: 'electronics',
    title: 'Electronics',
    description: 'Latest gadgets, smartphones, laptops, and tech accessories to power your digital life.',
    icon: 'lucide:laptop',
    color: 'primary'
  },
  {
    slug: 'fashion',
    title: 'Fashion & Clothing',
    description: 'Trendy clothing, stylish footwear, and fashion accessories for every occasion.',
    icon: 'lucide:shirt',
    color: 'secondary'
  },
  {
    slug: 'home-garden',
    title: 'Home & Garden',
    description: 'Beautiful furniture, smart appliances, and garden essentials to create your perfect space.',
    icon: 'lucide:home',
    color: 'accent'
  },
  {
    slug: 'books',
    title: 'Books & Education',
    description: 'Inspiring books, e-learning courses, and educational materials to expand your knowledge.',
    icon: 'lucide:book-open',
    color: 'success'
  },
  {
    slug: 'sports',
    title: 'Sports & Fitness',
    description: 'Premium sports gear, fitness equipment, and nutrition supplements for peak performance.',
    icon: 'lucide:dumbbell',
    color: 'warning'
  },
  {
    slug: 'arts-crafts',
    title: 'Arts & Crafts',
    description: 'Creative supplies, crafting materials, and art tools to unleash your imagination.',
    icon: 'lucide:palette',
    color: 'info'
  },
  {
    slug: 'health-wellness',
    title: 'Health & Wellness',
    description: 'Premium vitamins, natural supplements, and wellness products for optimal health.',
    icon: 'lucide:heart',
    color: 'success'
  },
  {
    slug: 'health-wellness-for-her',
    title: 'Health & Wellness for Her',
    description: 'Specialized wellness solutions designed specifically for women\'s health needs.',
    icon: 'lucide:heart',
    color: 'success'
  }
]

// Filtrar apenas categorias que t√™m produtos
const categoriesWithProducts = categories.filter(category =>
  productsByCategory[category.slug] && productsByCategory[category.slug].length > 0
)
---

<DefaultLayout title="Home">
  <Hero
    images={['/src/assets/images/posts/pexels-olly-972887.jpg', '/src/assets/images/posts/pexels-olly-1050244.jpg']}
    carousel={true}
    autoplay={4000}
  />

  <section class="my-32">
    <div class="container">
      <Heading level="h2" class="mb-6 text-center">üõçÔ∏è Discover Amazing Products</Heading>
      <p class="text-xl text-center mb-12 max-w-4xl mx-auto leading-relaxed">
        From cutting-edge electronics to wellness essentials, explore our curated collection designed to enhance your lifestyle and projects.
      </p>
      <div class="grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3">
        {categoriesWithProducts.map((category) => (
          <div class="category-card p-6 rounded-xl border border-border-color-subtle hover:shadow-xl transition-all duration-300 hover:scale-[1.02] hover:-translate-y-2 bg-gradient-to-br from-background to-background/50">
            <div class="text-center">
              <div class={`w-20 h-20 mx-auto mb-4 bg-gradient-to-br from-${category.color}-100 to-${category.color}-50 rounded-2xl flex items-center justify-center shadow-lg`}>
                <Icon name={category.icon} size="2.5rem" class={`text-${category.color}-600`} />
              </div>
              <Heading level="h3" class="mb-3 text-lg font-bold">{category.title}</Heading>
              <p class="text-muted mb-5 text-sm leading-relaxed min-h-[3rem] flex items-center justify-center">
                {category.description}
              </p>
              <Link href={`/${category.slug}`} isButton type="primary" class="w-full py-3 px-6 rounded-lg font-semibold shadow-md hover:shadow-lg transition-all duration-200">
                ‚ú® Explore Collection
              </Link>
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>
</DefaultLayout>

<style>
  .category-card {
    background: var(--color-background);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    backdrop-filter: blur(10px);
    border: 1px solid var(--color-border-subtle);

    &:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15), 0 0 0 1px var(--color-primary-200);
      background: linear-gradient(135deg, var(--color-background) 0%, var(--color-primary-50) 100%);
    }

    &::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, transparent 0%, rgba(255, 255, 255, 0.1) 50%, transparent 100%);
      opacity: 0;
      transition: opacity 0.3s ease;
      border-radius: inherit;
      pointer-events: none;
    }

    &:hover::before {
      opacity: 1;
    }
  }
</style>
